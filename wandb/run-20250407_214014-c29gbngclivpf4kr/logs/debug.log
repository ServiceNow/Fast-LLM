2025-04-07 21:40:14,163 INFO    MainThread:39908 [wandb_setup.py:_flush():67] Current SDK version is 0.19.9
2025-04-07 21:40:14,163 INFO    MainThread:39908 [wandb_setup.py:_flush():67] Configure stats pid to 39908
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_setup.py:_flush():67] Loading settings from /home/toolkit/.config/wandb/settings
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_setup.py:_flush():67] Loading settings from /home/toolkit/dev/Fast-LLM/wandb/settings
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_setup.py:_flush():67] Loading settings from environment variables
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_init.py:setup_run_log_directory():662] Logging user logs to /home/toolkit/dev/Fast-LLM/wandb/run-20250407_214014-c29gbngclivpf4kr/logs/debug.log
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_init.py:setup_run_log_directory():663] Logging internal logs to /home/toolkit/dev/Fast-LLM/wandb/run-20250407_214014-c29gbngclivpf4kr/logs/debug-internal.log
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_init.py:init():781] calling init triggers
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_init.py:init():786] wandb.init called with sweep_config: {}
config: {'run': {'experiment_dir': '/tmp/fast-llm-tutorial/experiment'}, 'model': {'base_model': {'transformer': {'normalization': {'type': 'rms_norm'}, 'peft': {'type': 'none', 'layers': ['query', 'value']}, 'num_layers': 16, 'hidden_size': 2048, 'num_attention_heads': 8, 'head_groups': 1, 'add_linear_biases': False, 'ffn_hidden_size': 8192, 'kv_channels': 256, 'gated': True, 'activation_type': 'silu', 'init_method_std': 0.02209708691207961, 'init_method_std_qkv': 0.02209708691207961, 'init_method_std_attn_proj': 0.00390625, 'init_method_std_mlp_1': 0.02209708691207961, 'init_method_std_mlp_2': 0.00390625, 'use_flash_attention': False, 'mlp_lr_scale': [None]}, 'vocab_size': 128256, 'use_position_embeddings': False, 'tie_word_embeddings': True, 'ssm': {'normalization': {'type': 'layer_norm'}, 'expansion_factor': 1, 'state_size': 64, 'conv_kernel_dimension': 4, 'add_bias_linear': False, 'dt_rank': 'auto', 'chunk_size': 128, 'n_qk_heads': 32, 'n_v_heads': 32, 'activation': 'identity', 'dt_min': 0.001, 'dt_max': 0.1, 'dt_init_floor': 0.0001}, 'block_pattern': ['m2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2', 'm2'], 'default_block': 'm2', 'init_method_std_embed': 0.02209708691207961, 'cross_entropy_impl': 'fused', 'use_fast_path': True}, 'distributed': {'world_size': 1, 'rank': 0, 'local_world_size': 1, 'training_dtype': 'bfloat16'}}, 'pretrained': {'format': 'llamba', 'path': '/mnt/checkpoints_fml/pretrained_models/Llamba-1B', 'load_config': 'architecture'}, 'training': {'evaluations': {'validation': {'interval': 1000, 'iterations': 25}}, 'logs': {'interval': 10}, 'export': {'format': 'llamba', 'optimizer_state': False, 'interval': 1000}, 'wandb': {'group_name': 'ssm', 'project_name': 'fast-llm-ssm-test', 'entity_name': 'tscholak'}, 'train_iters': 100}, 'batch': {'micro_batch_size': 1, 'depth_first_micro_batches': 1, 'breadth_first_micro_batches': 1, 'sequential_micro_batches': 1, 'batch_size': 1, 'sequence_length': 2048, 'micro_sequence_length': 2048}, 'data': {'split': [969.0, 30.0, 1.0], 'fim': {'rate': 0.0}, 'tokenizer': {'path': None}, 'datasets': {'training': {'type': 'memmap', 'path': '/home/toolkit/dev/fast-llm-tutorial/dataset/shard_0_0'}, 'validation': {'type': 'memmap', 'path': '/home/toolkit/dev/fast-llm-tutorial/dataset/shard_0_0'}}}, 'profiling': {'cuda': False}, 'optimizer': {'learning_rate': {'base': 0.0001}, 'weight_decay': 0.01}, '_wandb': {}}
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_init.py:init():809] starting backend
2025-04-07 21:40:14,164 INFO    MainThread:39908 [wandb_init.py:init():813] sending inform_init request
2025-04-07 21:40:14,192 INFO    MainThread:39908 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-04-07 21:40:14,193 INFO    MainThread:39908 [wandb_init.py:init():823] backend started and connected
2025-04-07 21:40:14,196 INFO    MainThread:39908 [wandb_init.py:init():915] updated telemetry
2025-04-07 21:40:14,516 INFO    MainThread:39908 [wandb_init.py:init():939] communicating run to backend with 90.0 second timeout
2025-04-07 21:40:14,692 INFO    MainThread:39908 [wandb_init.py:init():1014] starting run threads in backend
2025-04-07 21:40:15,381 INFO    MainThread:39908 [wandb_run.py:_console_start():2454] atexit reg
2025-04-07 21:40:15,382 INFO    MainThread:39908 [wandb_run.py:_redirect():2306] redirect: wrap_raw
2025-04-07 21:40:15,383 INFO    MainThread:39908 [wandb_run.py:_redirect():2371] Wrapping output streams.
2025-04-07 21:40:15,384 INFO    MainThread:39908 [wandb_run.py:_redirect():2394] Redirects installed.
2025-04-07 21:40:15,399 INFO    MainThread:39908 [wandb_init.py:init():1056] run started, returning control to user process
